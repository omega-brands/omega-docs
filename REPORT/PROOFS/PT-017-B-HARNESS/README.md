# PT-017-B: Proof Harness for Revocation Policy Automation

**Status:** ğŸš€ READY FOR EXECUTION  
**Date:** 2026-02-07  
**Repo:** `omega-docs`  
**Depends on:** `omega-core` runtime seal tag `omega-proof-campaign-pt017-runtime` @ `1d21395â€¦`  
**Reference:** PT-016-B harness at `omega-proof-campaign-pt016-runtime` @ `46898b2â€¦`

---

## ğŸ¯ Objective

Prove that policy-driven revocation automation is:
- âœ… Deterministic (same policy + context = same decision)
- âœ… Fail-closed (ambiguity defaults to NO_ACTION)
- âœ… Governed (routes through PT-016 paths, never bypasses)
- âœ… Auditable (FC events include policy attribution)
- âœ… Guarded (human gates enforced, cooldown respected)

---

## ğŸ“‹ Prerequisites

1. **Docker running** with `omega-federation-core-prod` container
2. **FC accessible** at `http://localhost:9405`
3. **Python 3.10+** with `httpx`, `asyncio`
4. **Environment variables:**
   ```powershell
   $env:FC_BASE_URL = "http://localhost:9405"
   $env:SECRET_KEY = "bWVtYmVyaGFuZHNvbWVub3NoYXBlcmVtZW1iZXJib3htb25rZXluYXRpdmVkaXJlY3Q="
   ```

---

## ğŸš€ Quick Start

### 1. Run the harness

```powershell
cd REPORT/PROOFS/PT-017-B-HARNESS
python pt017_b_policy_harness.py
```

### 2. Expected output

```
======================================================================
PT-017-B: PROOF HARNESS FOR REVOCATION POLICY AUTOMATION
======================================================================
[OK] Generated bearer token

[SCENARIO 1] VERIFY_FAIL Trigger
[OK] Created entity with invalid receipt
[OK] Policy evaluation triggered on verify-fail
[OK] Revocation recommended (RECOMMEND severity)
[OK] FC_GENESIS_REVOKED event emitted with policy attribution
[OK] Ledger shows policy_version and automation flag
[OK] Receipt chain verified

[SCENARIO 2] POST_DEATH_ACTION Trigger
[OK] Created and revoked entity
[OK] Attempted invocation of dead entity
[OK] Policy evaluation triggered on post-death-action
[OK] Termination initiated (AUTO_TERMINATE severity)
[OK] FC_GENESIS_TERMINATED event emitted with policy attribution
[OK] Ledger shows policy_version and automation flag

[SCENARIO 3] INVALID_MANIFEST Trigger
[OK] Created entity with manifest drift
[OK] Policy evaluation triggered on invalid-manifest
[OK] Revocation recommended
[OK] FC event includes trigger_events

[SCENARIO 4] DRIFT Trigger
[OK] Created entity with state divergence
[OK] Policy evaluation triggered on drift
[OK] Revocation recommended
[OK] Guardrails enforced (cooldown, human gate)

[SCENARIO 5] LIFECYCLE_EVENT Trigger
[OK] Created entity
[OK] Policy evaluation triggered on lifecycle-event
[OK] Revocation recommended
[OK] Human gate requirement enforced

[SCENARIO 6] Fail-Closed Ambiguity
[OK] Missing birth receipt â†’ NO_ACTION (fail-closed)
[OK] Incomplete ledger â†’ NO_ACTION (fail-closed)
[OK] Already-dead entity â†’ NO_ACTION (fail-closed)
[OK] Cooldown violation â†’ NO_ACTION (fail-closed)

======================================================================
EVIDENCE BUNDLE GENERATED
```

---

## ğŸ“ Directory Structure

```
PT-017-B-HARNESS/
â”œâ”€â”€ README.md                          # This file
â”œâ”€â”€ SCENARIOS.md                       # Detailed scenario specifications
â”œâ”€â”€ PT-017_B_CAMPAIGN_COMPLETE.md      # Seal document
â”œâ”€â”€ pt017_b_policy_harness.py          # Full async Python harness
â””â”€â”€ EVIDENCE/                          # Generated by harness
    â”œâ”€â”€ run_<timestamp>/
    â”‚   â”œâ”€â”€ fc_logs_excerpt.txt
    â”‚   â”œâ”€â”€ ledger_extract.json
    â”‚   â”œâ”€â”€ policy_evaluations.json
    â”‚   â”œâ”€â”€ receipts/
    â”‚   â”‚   â”œâ”€â”€ birth_receipt.json
    â”‚   â”‚   â”œâ”€â”€ revoke_receipt.json
    â”‚   â”‚   â””â”€â”€ verification_output.json
    â”‚   â”œâ”€â”€ assertions/
    â”‚   â”‚   â”œâ”€â”€ policy_attribution.json
    â”‚   â”‚   â”œâ”€â”€ fail_closed_cases.json
    â”‚   â”‚   â””â”€â”€ guardrail_enforcement.json
    â”‚   â””â”€â”€ manifest.json               # SHA256 hashes of all evidence
```

---

## ğŸ”— Integration Points

- **PT-016 Runtime:** `revoke_entity()`, `terminate_entity()` paths
- **PT-017 Runtime:** `PolicyEvaluator`, `AutomationGuardrails`, `PolicyAutomationOrchestrator`
- **FC Events:** `FC_GENESIS_REVOKED`, `FC_GENESIS_TERMINATED` with policy context
- **Ledger:** Death events include `policy_version`, `automation`, `trigger_event_ids`

---

## âœ… Verification Checklist

- [ ] All 5 trigger types exercised
- [ ] Fail-closed cases verified
- [ ] Human gate enforcement confirmed
- [ ] Cooldown enforcement confirmed
- [ ] FC event attribution verified
- [ ] Receipt chains validated
- [ ] Evidence bundle generated with manifest
- [ ] PT-017_CAMPAIGN_COMPLETE seal created

---

**This is the way. ğŸ”±**

